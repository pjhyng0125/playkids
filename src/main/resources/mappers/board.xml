<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">
 	<select id="select_list" resultType="BoardVO">
 		select bno, category, mid, title, regdate, count from board
 		order by bno desc
 	</select>
 	
 	<insert id="insert_board">
 		insert into board(bno, category, title, content, mid)
     	values (board_seq.nextval, #{category}, #{title}, #{content}, #{mid})
 	</insert>
 	
 	<delete id="delete_board">
 		delete from board 
 		where bno=#{bno}
 	</delete>
 	
 	<update id="update_boad">
 		update board
 		set category=#{category}, title=#{title}, content=#{content}
   		where bno=#{bno}
 	</update>
 	
 	<select id="select_board" resultType="BoardVO">
 		select bno, category, mid, title, regdate, count from board
 		where bno=#{bno}
 	</select>
 	
 	<!-- ***************************** -->
 	
 	<!-- 전체 행의수 구하기 -->
  <select id="selectTotalCount" resultType="int">
  	select count(*)
  	from board
  </select>
  
  <!-- 공통된 sql문 작성 저장   -->
  <sql id="search">
  	<if test="searchType!=null">
  		<choose>
  			<when test="searchType=='t'.toString()">
  				where title like '%'||#{keyword}||'%'
  			</when>
  			<when test="searchType=='c'.toString()">
  				where content like '%'||#{keyword}||'%'
  			</when>
  			<when test="searchType=='w'.toString()">
  				where writer like '%'||#{keyword}||'%'
  			</when>
  		</choose>
  	</if>
  </sql>
  

  
  <select id="listSearch" resultType="BoardVO">
  	select * 
  	from board
  	<include refid="search"></include>
  	order by bno desc
  </select>
  
  <select id="listSearchCount" resultType="int">
  	select count(*) 
  	from board 
  	<include refid="search"></include>
  </select>
 	
 	
</mapper>
